---
title: "Rotenone Mortality"
author: "Vincent Tam"
date: "February 12, 2019"
output: github_document
---

```{r}
library(tidyverse)
library(janitor)
library(broom)
library(httk)
library(drc)
library(ggplot2)
library(GGally)
library(scatterplot3d)
mortality = read_csv("./RotenoneMortalityRate.csv")

## Replication 1
lo1 <- loess(mortality$`Grp 1 Mortality Rate`~mortality$`Concentration (micromolar)`)
plot(mortality$`Concentration (micromolar)`, mortality$`Grp 1 Mortality Rate`,
     main = "Replication 1", sub = "Rotenone Dose-Response Curve",
     xlab = "Rotenone Concentration (micromolar)", ylab = "Mortality Rate",
     ylim = c(0, 0.45))
x1 = seq(min(mortality$`Concentration (micromolar)`),
         max(mortality$`Concentration (micromolar)`), 
         (max(mortality$`Concentration (micromolar)`) -
         min(mortality$`Concentration (micromolar)`))/1000)
lines(x1, predict(lo1,x1), col = 'red', lwd = 2)
fit1 = lm(mortality$`Concentration (micromolar)` ~ mortality$`Grp 1 Mortality Rate`) 
summary(fit1)
fitted(fit1)
fit1 %>% 
  broom::tidy()
pred1 = glm(factor(mortality$`Concentration (micromolar)`) ~ mortality$`Grp 1 Mortality Rate`, family = binomial(link = "logit"))
summary(pred1)
predict(pred1, type = "response")
pred1 %>%
  broom::tidy()
abline(lm(mortality$`Concentration (micromolar)` ~ mortality$`Grp 1 Mortality Rate`))
data.frame(Concentration = mortality$`Concentration (micromolar)`, Mortality = mortality$`Grp 1 Mortality Rate`, Fitted = fitted(fit1), Predicted = predict(pred1, type = "response"))
ggpairs(data = mortality, columns = 1:4, title="Group 1 Mortality Data - relationship between predictor and response variables")
ggplot(data=mortality, aes(fit1$residuals)) + 
  geom_histogram(binwidth = 0.25, color = "black", fill = "purple4") +
  theme(panel.background = element_rect(fill = "white"),
        axis.line.x=element_line(),
        axis.line.y=element_line()) +
  ggtitle("Histogram for Group 1 Fitted Model Residuals") 
ggplot(data = mortality, aes(x = `Concentration (micromolar)`, y = `Grp 1 Mortality Rate`)) + geom_point()  +
  stat_smooth(method = "lm", col = "dodgerblue3") +
  theme(panel.background = element_rect(fill = "white"),
        axis.line.x=element_line(),
        axis.line.y=element_line()) +
  ggtitle("Replication 1 Linear Model Fitted to Data")

## Replication 2
lo2 <- loess(mortality$`Grp 2 Mortality Rate`~mortality$`Concentration (micromolar)`)
plot(mortality$`Concentration (micromolar)`, mortality$`Grp 2 Mortality Rate`,
     main = "Replication 2", sub = "Rotenone Dose-Response Curve",
     xlab = "Rotenone Concentration (micromolar)", ylab = "Mortality Rate",
     ylim = c(0, 0.45))
x2 = seq(min(mortality$`Concentration (micromolar)`),
         max(mortality$`Concentration (micromolar)`), 
         (max(mortality$`Concentration (micromolar)`) -
         min(mortality$`Concentration (micromolar)`))/1000)
lines(x2, predict(lo2,x2), col = 'red', lwd = 2)
fit2 = lm(mortality$`Concentration (micromolar)` ~ mortality$`Grp 2 Mortality Rate`) 
summary(fit2)
fitted(fit2)
fit2 %>% 
  broom::tidy()
pred2 = glm(factor(mortality$`Concentration (micromolar)`) ~ mortality$`Grp 2 Mortality Rate`, family = binomial(link = "logit"))
summary(pred2)
predict(pred2, type = "response")
pred2 %>%
  broom::tidy()
abline(lm(mortality$`Concentration (micromolar)` ~ mortality$`Grp 2 Mortality Rate`))
data.frame(Concentration = mortality$`Concentration (micromolar)`, Mortality = mortality$`Grp 2 Mortality Rate`, Fitted = fitted(fit2), Predicted = predict(pred2, type = "response"))
col.index2 = c(1,5,6,7)
ggpairs(data = mortality, columns = col.index2, title="Group 2 Mortality Data - relationship between predictor and response variables")
ggplot(data=mortality, aes(fit2$residuals)) + 
  geom_histogram(binwidth = 0.25, color = "black", fill = "purple4") +
  theme(panel.background = element_rect(fill = "white"),
        axis.line.x=element_line(),
        axis.line.y=element_line()) +
  ggtitle("Histogram for Group 2 Fitted Model Residuals") 
ggplot(data = mortality, aes(x = `Concentration (micromolar)`, y = `Grp 2 Mortality Rate`)) + geom_point()  +
  stat_smooth(method = "lm", col = "dodgerblue3") +
  theme(panel.background = element_rect(fill = "white"),
        axis.line.x=element_line(),
        axis.line.y=element_line()) +
  ggtitle("Replication 2 Linear Model Fitted to Data")

## Replication 3
lo3 <- loess(mortality$`Grp 3 Mortality Rate`~mortality$`Concentration (micromolar)`)
plot(mortality$`Concentration (micromolar)`, mortality$`Grp 3 Mortality Rate`,
     main = "Replication 3", sub = "Rotenone Dose-Response Curve",
     xlab = "Rotenone Concentration (micromolar)", ylab = "Mortality Rate",
     ylim = c(0, 0.4))
x3 = seq(min(mortality$`Concentration (micromolar)`),
         max(mortality$`Concentration (micromolar)`), 
         (max(mortality$`Concentration (micromolar)`) -
         min(mortality$`Concentration (micromolar)`))/1000)
lines(x3, predict(lo3,x3), col = 'red', lwd = 2)
fit3 = lm(mortality$`Concentration (micromolar)` ~ mortality$`Grp 3 Mortality Rate`) 
summary(fit3)
fitted(fit3)
fit3 %>% 
  broom::tidy()
pred3 = glm(factor(mortality$`Concentration (micromolar)`) ~ mortality$`Grp 3 Mortality Rate`, family = binomial(link = "logit"))
summary(pred3)
predict(pred3, type = "response")
pred3 %>%
  broom::tidy()
abline(lm(mortality$`Concentration (micromolar)` ~ mortality$`Grp 3 Mortality Rate`))
data.frame(Concentration = mortality$`Concentration (micromolar)`, Mortality = mortality$`Grp 3 Mortality Rate`, Fitted = fitted(fit3), Predicted = predict(pred3, type = "response"))
col.index2 = c(1,8,9,10)
ggpairs(data = mortality, columns = col.index2, title="Group 3 Mortality Data - relationship between predictor and response variables")
ggplot(data=mortality, aes(fit3$residuals)) + 
  geom_histogram(binwidth = 0.25, color = "black", fill = "purple4") +
  theme(panel.background = element_rect(fill = "white"),
        axis.line.x=element_line(),
        axis.line.y=element_line()) +
  ggtitle("Histogram for Group 3 Fitted Model Residuals") 
ggplot(data = mortality, aes(x = `Concentration (micromolar)`, y = `Grp 3 Mortality Rate`)) + geom_point()  +
  stat_smooth(method = "lm", col = "dodgerblue3") +
  theme(panel.background = element_rect(fill = "white"),
        axis.line.x=element_line(),
        axis.line.y=element_line()) +
  ggtitle("Replication 3 Linear Model Fitted to Data")

## Replication 4
lo4 <- loess(mortality$`Grp 4 Mortality Rate`~mortality$`Concentration (micromolar)`)
plot(mortality$`Concentration (micromolar)`, mortality$`Grp 4 Mortality Rate`,
     main = "Replication 4", sub = "Rotenone Dose-Response Curve",
     xlab = "Rotenone Concentration (micromolar)", ylab = "Mortality Rate",
     ylim = c(0, 0.5))
x4 = seq(min(mortality$`Concentration (micromolar)`),
         max(mortality$`Concentration (micromolar)`), 
         (max(mortality$`Concentration (micromolar)`) -
         min(mortality$`Concentration (micromolar)`))/1000)
lines(x4, predict(lo4,x4), col = 'red', lwd = 2)
fit4 = lm(mortality$`Concentration (micromolar)` ~ mortality$`Grp 4 Mortality Rate`) 
summary(fit4)
fitted(fit4)
fit4 %>% 
  broom::tidy()
pred4 = glm(factor(mortality$`Concentration (micromolar)`) ~ mortality$`Grp 4 Mortality Rate`, family = binomial(link = "logit"))
summary(pred4)
predict(pred4, type = "response")
pred4 %>%
  broom::tidy()
abline(lm(mortality$`Concentration (micromolar)` ~ mortality$`Grp 4 Mortality Rate`))
data.frame(Concentration = mortality$`Concentration (micromolar)`, Mortality = mortality$`Grp 4 Mortality Rate`, Fitted = fitted(fit4), Predicted = predict(pred4, type = "response"))
col.index2 = c(1,11,12,13)
ggpairs(data = mortality, columns = col.index2, title="Group 4 Mortality Data - relationship between predictor and response variables")
ggplot(data=mortality, aes(fit4$residuals)) + 
  geom_histogram(binwidth = 0.25, color = "black", fill = "purple4") +
  theme(panel.background = element_rect(fill = "white"),
        axis.line.x=element_line(),
        axis.line.y=element_line()) +
  ggtitle("Histogram for Group 4 Fitted Model Residuals") 
ggplot(data = mortality, aes(x = `Concentration (micromolar)`, y = `Grp 4 Mortality Rate`)) + geom_point()  +
  stat_smooth(method = "lm", col = "dodgerblue3") +
  theme(panel.background = element_rect(fill = "white"),
        axis.line.x=element_line(),
        axis.line.y=element_line()) +
  ggtitle("Replication 4 Linear Model Fitted to Data")
  
## Replication 5
lo5 <- loess(mortality$`Grp 5 Mortality Rate`~mortality$`Concentration (micromolar)`)
plot(mortality$`Concentration (micromolar)`, mortality$`Grp 5 Mortality Rate`,
     main = "Replication 5", sub = "Rotenone Dose-Response Curve",
     xlab = "Rotenone Concentration (micromolar)", ylab = "Mortality Rate",
     ylim = c(0, 0.45))
x5 = seq(min(mortality$`Concentration (micromolar)`),
         max(mortality$`Concentration (micromolar)`), 
         (max(mortality$`Concentration (micromolar)`) -
         min(mortality$`Concentration (micromolar)`))/1000)
lines(x5, predict(lo5,x5), col = 'red', lwd = 2)
fit5 = lm(mortality$`Concentration (micromolar)` ~ mortality$`Grp 5 Mortality Rate`) 
summary(fit5)
fitted(fit5)
fit5 %>% 
  broom::tidy()
pred5 = glm(factor(mortality$`Concentration (micromolar)`) ~ mortality$`Grp 5 Mortality Rate`, family = binomial(link = "logit"))
summary(pred5)
predict(pred5, type = "response")
pred5 %>%
  broom::tidy()
abline(lm(mortality$`Concentration (micromolar)` ~ mortality$`Grp 5 Mortality Rate`))
data.frame(Concentration = mortality$`Concentration (micromolar)`, Mortality = mortality$`Grp 5 Mortality Rate`, Fitted = fitted(fit5), Predicted = predict(pred5, type = "response"))
col.index2 = c(1,14,15,16)
ggpairs(data = mortality, columns = col.index2, title="Group 5 Mortality Data - relationship between predictor and response variables")
ggplot(data=mortality, aes(fit5$residuals)) + 
  geom_histogram(binwidth = 0.25, color = "black", fill = "purple4") +
  theme(panel.background = element_rect(fill = "white"),
        axis.line.x=element_line(),
        axis.line.y=element_line()) +
  ggtitle("Histogram for Group 5 Fitted Model Residuals") 
ggplot(data = mortality, aes(x = `Concentration (micromolar)`, y = `Grp 5 Mortality Rate`)) + geom_point()  +
  stat_smooth(method = "lm", col = "dodgerblue3") +
  theme(panel.background = element_rect(fill = "white"),
        axis.line.x=element_line(),
        axis.line.y=element_line()) +
  ggtitle("Replication 5 Linear Model Fitted to Data")

## Replication 6
lo6 <- loess(mortality$`Grp 6 Mortality Rate`~mortality$`Concentration (micromolar)`)
plot(mortality$`Concentration (micromolar)`, mortality$`Grp 6 Mortality Rate`,
     main = "Replication 6", sub = "Rotenone Dose-Response Curve",
     xlab = "Rotenone Concentration (micromolar)", ylab = "Mortality Rate",
     ylim = c(0, 0.55))
x6 = seq(min(mortality$`Concentration (micromolar)`),
         max(mortality$`Concentration (micromolar)`), 
         (max(mortality$`Concentration (micromolar)`) -
         min(mortality$`Concentration (micromolar)`))/1000)
lines(x6, predict(lo6,x6), col = 'red', lwd = 2)
fit6 = lm(mortality$`Concentration (micromolar)` ~ mortality$`Grp 6 Mortality Rate`) 
summary(fit6)
fitted(fit6)
fit6 %>% 
  broom::tidy()
pred6 = glm(factor(mortality$`Concentration (micromolar)`) ~ mortality$`Grp 6 Mortality Rate`, family = binomial(link = "logit"))
summary(pred6)
predict(pred6, type = "response")
pred6 %>%
  broom::tidy()
abline(lm(mortality$`Concentration (micromolar)` ~ mortality$`Grp 6 Mortality Rate`))
data.frame(Concentration = mortality$`Concentration (micromolar)`, Mortality = mortality$`Grp 6 Mortality Rate`, Fitted = fitted(fit6), Predicted = predict(pred6, type = "response"))
col.index2 = c(1,17,18,19)
ggpairs(data = mortality, columns = col.index2, title="Group 6 Mortality Data - relationship between predictor and response variables")
ggplot(data=mortality, aes(fit6$residuals)) + 
  geom_histogram(binwidth = 0.25, color = "black", fill = "purple4") +
  theme(panel.background = element_rect(fill = "white"),
        axis.line.x=element_line(),
        axis.line.y=element_line()) +
  ggtitle("Histogram for Group 6 Fitted Model Residuals") 
ggplot(data = mortality, aes(x = `Concentration (micromolar)`, y = `Grp 6 Mortality Rate`)) + geom_point()  +
  stat_smooth(method = "lm", col = "dodgerblue3") +
  theme(panel.background = element_rect(fill = "white"),
        axis.line.x=element_line(),
        axis.line.y=element_line()) +
  ggtitle("Replication 6 Linear Model Fitted to Data")
```